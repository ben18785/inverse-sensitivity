\section{Introduction}
Variation, as opposed to homogeneity, is the rule rather than exception in biology. Indeed, without variation, biology as a discipline would not exist, since as evolutionary biologist JBS Haldane wrote, variation is the ``raw material" of evolution. The Red Queen Hypothesis asserts organisms must continually evolve in order to survive when pitted against other - also evolving - organisms \cite{ridley1994red}. A corollary of this hypothesis is that multicellular organisms should evolve cellular phenotypic heterogeneity to allow faster adaptation to changing environments, which may explain the observed variation in a range of biological systems \cite{fraser2009chance}. Whilst cell population variation can confer evolutionary advantages, it can also be costly in other circumstances. In biotechnological processes, heterogeneity in cellular function can lead to reduced yields of biochemical products \cite{delvigne2014metabolic}. In human biology, variation across cells can enable pathologies to develop and also prevents effective medical treatment, since medical interventions typically aim to steer modal cellular properties and hence fail to influence key subpopulations. For example, cellular heterogeneity likely helps some cancerous tumours to persist \cite{gatenby2007cellular} and facilitates evolution of resistance to chemotherapies \cite{altrock2015mathematics}. Identifying and quantifying sources of variation in populations of cells is important for wide ranging applications to discern whether the variability is benign or alternatively requires remedy.

Mathematical models are essential tools for understanding cellular systems, whose emergent properties are the result of complex interactions between various actors. Perhaps the simplest flavour of mathematical model used in biological systems is an ordinary differential equation (ODE) that lumps individual actors into partitions according to structure or function, and seeks to model the mean behaviour of each partition. Data from population-averaged experimental assays can determine whether such models faithfully reproduce system behaviours and can allow quantification of the interactions of various cellular components of complex metabolic, signalling and transcriptional networks. The worth of such models however depends on whether averages mask individual differences in behaviour that result in functional consequences \cite{altschuler2010cellular}. In some cases, differences in cellular protein abundances due to biochemical ``noise" are not biologically meaningful  \cite{elowitz2002stochastic} and the system is well described by average cell behaviour. In others there are functional consequences. For example, a laboratory study demonstrated subpopulations of clonally-derived hematopoietic progenitor cells with low or high expression of a particular stem cell marker produced different blood lineages \cite{chang2008transcriptome}.

To accommodate cell population heterogeneity in mathematical models, many modelling frameworks are available, each posing different challenges for parameter inference. A recent review is presented in \cite{waldherr2018estimation}. These approaches include modelling biochemical processes stochastically, with properties of ensembles of cells represented by probability distributions evolving according to chemical master equations (see \cite{erban2007practical} for a tutorial on stochastic reaction-diffusion processes; RDEs). Alternatively, population balance equations (PBEs) can be used to dictate the evolution of the ``number density" of differing cell types, whose properties are represented as points in $\mathbb{R}^n$ which, in turn, affect their function, including their rate of death and cell division (see \cite{ramkrishna2014population} for an introduction to PBEs). In a PBE approach, variation in measured quantities results primarily from differing functional properties of heterogeneous cell types and variable initial densities of each type.

The approach we follow here is similar to that of \cite{dixit2018maximum}, wherein dynamic cellular variation is generated by describing the evolution of each cell's state using an ODE, but with individual cell differences in the rate parameters of the process. To our knowledge, this flavour of model is unnamed and so, for sake of reference, we term them ``heterogenous ODE" models (HODEs). In HODEs, the aim of inference is to estimate distributions of parameter values across cells consistent with observations. A benefit of using HODEs to model cell heterogeneity is these models are computationally straightforward to simulate and, arguably, simpler to parameterise than PBEs. An implicit assumption in using HODEs is that most observed variation comes from differences in biological processes across cells, not inherent stochasticity in biochemical reactions within cells, as in stochastic RDEs.

Inference for HODEs is partly difficult due to the hurdle of generating experimental data of sufficient quality to allow parameter identification. Unlike models which represent a population by a single scalar ODE, since HODEs are individual-based, they ideally require individual cell data for estimation. A widely-used method for generating such data is flow cytometry, where a large number of cells are streamed individually through a laser beam and, for example, abundance measurements are made of proteins labelled with fluorescent markers \cite{telford2012flow}. Other experimental techniques, including Western blotting and cytometric fluorescence microscopy, can also generate single cell measurements \cite{hughes2014single,hasenauer2011identification}. These experimental methods are all however destructive, meaning individual cells are sacrificed during measurement, and  observations at each time point represent \emph{``snapshots"} of the underlying population \cite{hasenauer2011identification}. These snapshots are often described by histograms \cite{dixit2018maximum} or density functions \cite{waldherr2018estimation} fit to measurements of each quantity of interest. Since HODEs assume the state of each cell evolves continuously over time, experimental data tracing individual cell trajectories through time constitutes a richer data resource. The demands of obtaining this data are higher however and typically involve either tracking individual cells through imaging methods \cite{hilsenbeck2016software} or trapping cells in a spatial position where their individual dynamics can be readily monitored \cite{fritzsch2012single}. These techniques impose restrictions on experimental practices and are often inapplicable, including for online monitoring of biotechnological processes or analysis of \textit{in vivo} studies. For this reason, ``snapshot'' data continues to play an important role for determining cell level variability in many applications.

A variety of approaches have been proposed to estimate cellular variability by fitting HODE models to snapshot data. In HODEs, parameter values vary across cells according to a to-be-determined probability distribution, meaning that to solve the exact inverse problem, the underlying ODE system should be simulated for each individual. Since the numbers of cells in these experiments typically exceed $\sim10^4$ \cite{hasenauer2011identification}, exact inference is infeasible due to computational burden and instead the raw snapshot data are approximated by probability densities \cite{hasenauer2011identification,hasenauer2014ode,loos2018hierarchical,dixit2018maximum}. Hasenauer et al. (2011) presents a Bayesian approach to inference for HODEs, which models the input parameter space using mixtures of ansatz densities. The authors then use their method to reproduce population substructure on synthetic data generated from a model of tumour necrosis factor stimulus. Hasenauer et al. (2014) uses mixture models to model subpopulation structure in snapshot data with multiple-start local optimisation employed to maximise the non-convex likelihood, which they then apply to synthetic and real data from signalling pathway models. Loos et al. (2018) also uses mixture models to represent subpopulation structure and a maximum likelihood approach allowing estimation of within- and between-subpopulation variability which permits fitting to multivariate output distributions with complex correlation structures. Dixit et al. (2018) assigns observations into discrete bins, then uses a maximum entropy approach in a Bayesian framework to estimate cell variability.

Our framework is Bayesian although is distinct from the approach used to fit many dynamic models, since here we assume stochasticity arises solely due to variation in parameters across cells, not due to measurement noise. The approach is hence most suitable when measurement error is not a dominant source of observed experimental variability. Our computational method is a two-step Monte Carlo approach which, for reasons described in \S \ref{sec:method}, we term ``Contour Monte Carlo'' (CMC). Unlike many existing methods, CMC is computationally straightforward to implement and does not require extensive computation time. CMC uses MCMC in its second step to sample from the posterior distribution over parameter values and hence does not require specification of ansatz densities. It also does not require \textit{a priori} representation of subpopulation structure using mixture components, rather, subpopulations emerge as modes in the posterior parameter distributions. Like \cite{loos2018hierarchical}, CMC can fit multivariate snapshot data and unlike \cite{dixit2018maximum}, does not require this data to be discretised into bins. As more experimental techniques elucidating single cell behaviour are developed, there will likely be more interest in models which can recapitulate observation snapshots. We argue that due to its simplicity and generality, CMC is a useful addition to the modeller's toolkit and can be used to perform inference on the proliferation of rich single cell data.


\underline{Outline of the paper}: In \S \ref{sec:method}, we present the details of our methodological framework and detail the CMC algorithm used to generate samples from the posterior parameter distribution. In \S \ref{sec:results}, we use CMC to estimate cell population heterogeneity in three systems of biological interest.


