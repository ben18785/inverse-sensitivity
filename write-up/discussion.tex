\section{Discussion}
\label{sec:discussion}
Determining the cause of variability in cellular processes is crucial in many applications, ranging from bioengineering to drug development. In this paper, we introduce a Bayesian method for estimating cellular heterogeneity from ``snapshot'' measurements of cellular properties, taken at discrete intervals throughout the experimental course. Our approach assumes what we term a ``heterogeneous ordinary differential equation'' (HODE) framework, in which biochemical processes in individual cells are assumed to follow dynamics governed by a common ODE, although with idiosyncratic differences in parameter values. In this framework, estimating heterogeneity in cellular processes amounts to determining the probability distributions over parameter values of the governing ODE. Our method of estimation is a two-step Monte Carlo sampling process we term ``Contour Monte Carlo'' (CMC) which does not require \textit{a priori} specification of cell population substructure unlike other approaches. CMC can be used to process high volumes of individual cellular measurements since the framework involves fitting a kernel density estimator to raw experimental data and using these distributions rather than data as the target outcome. CMC also allows for arbitrary multivariate structure in the measurement space, meaning it can capture correlations that occur between the same cellular species at different timepoints or, for example, contemporaneous correlations between different cellular compartments. Being a Bayesian approach, CMC uses prior distributions over parameter values to ensure uniqueness of the posterior distribution, allowing pre-experimental knowledge to be used to improve estimation robustness. The flexible and robust framework that CMC provides means it can be used to do automatic inference for wide-ranging systems of practical interest.

Our approach also provides a natural way to test that the process is working. By feeding the posterior parameter samples obtained by CMC into forward model simulations, this results in a distribution over output values that can be compared to the target. Indeed, we have found this comparison indispensable in applying CMC in practice and include it as the last step in the CMC algorithm (Algorithm \ref{alg:cmc}). Discrepancies between the target output distribution and samples from it by CMC can occur either as a result of poor estimates of the ``contour volume distribution'' in the first stage of the algorithm or due to insufficient MCMC samples in the second. Either of these issues can often be easily addressed and although kernel density estimation in high dimensional spaces remains an open research problem, we have found vine copula kernel density estimation works well for the dimensionality of output measurements we investigate here \cite{nagler2016evading}.

Failure to reproduce a given output distribution can also indicate that the generating model (the priors and the forward model) are incongruent with experimental results. This may either be due to misspecification of the ODE system or the inadequacy of the assumed deterministic framework. Our approach currently assumes that output stochasticity is dominated by cellular variation in the parameter values of the underlying ODE, with measurement noise making a negligible contribution. Whether this is a reasonable assumption depends on the system under investigation and, more importantly, on experimental details. We recognise that neglecting measurement noise when it is an important determinant of the observed data means CMC will overstate cellular variation. It may also mean that some output distributions cannot be obtained by our model system (the HODEs without noise). Future work allowing inclusion of a stochastic noise process or, more generally, including stochastic cellular mechanisms is thus likely to be worthwhile.

Whilst we have labelled the approach we follow here as Bayesian, since it involves explicit estimation of probability distributions and involves priors over parameter values, we recognise that it is not in the form typically utilised by exponents of this framework. This is because rather than aiming to formulate a model that describes output observations, instead, our approach aims to recapitulate output distributions. Others \cite{BJW-18}, (including us \cite{lambert2018inverse}), have considered similar problems before; perhaps most notably by Albert Tarantola in his landmark work on inverse problem theory (see, for example, \cite{tarantola2005inverse}). In Tarantola's framework, a joint input parameter \& output space is considered, where prior knowledge and experimental theory combine elegantly to produce a posterior distribution whose marginal output distribution is a weighted ``conjunction'' of various sources of measurement. Whilst we believe the inverse problems covered by the Tarantola framework are different to ours (Tarantola combines parameter-output measurement distributions via ``conjunctions'' whereas we use push-forward measures resulting from inputting parameter values into the forward map), there are equivalences between the two frameworks. This work has seen considerable interest in areas such as the geosciences \cite{mosegaard1995monte,vukicevic2008analysis}, and we propose that these methods may prove useful for the biosciences. In particular, we posit that this approach provides a single framework for generalised Bayesian inference that encompasses either output data or output distributions as outcome measures.

The natural world is rife with variation. Mathematical models represent frameworks for understanding the causes of such variation. Typically, the state of biological knowledge is such that one effect, a given pattern of variation, has many possible causes, and observational or experimental data are necessary to apportion weight to each of them, in a process which amounts to solving an inverse problem. The approach we describe here follows the Bayesian paradigm of inverse problem solving whereby uncertainty in potential causes is reflected by probability distributions. Here, we illustrate the utility of our method by applying it to estimate cellular heterogeneity in biochemical processes however, it could equally be used to understand the inversion of deterministic systems more generally. Whilst describing the inversion process of deterministic models using probability distributions may sound contradictory, it is worth acknowledging that many ODE systems are structurally unidentified meaning there is irreducible uncertainty over some regions of parameter space. Contour Monte Carlo provides an automatic framework for performing inference on these deterministic systems and the use of priors allows for robust and precise parameter estimation unattainable through the data alone.

